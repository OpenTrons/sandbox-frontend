{% extends "/layout.html" %} {% block styles %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/walkthrough.css') }}"> {% endblock %} {% block body %}
<style type="text/css">
.steps .step {
    display: none;
}

.steps .step.active-step {
    display: block;
}
</style>
<div class="deck">
    <aside class="step-list">
        <ul id="step-group">
            <li class="welcome">Welcome</li>
            <li class="one">Step 1- Calibrate p200 tiprack</li>
            <li class="two">Echo steps from Michelle</li>
            <li class="three">Echo steps from Michelle</li>
        </ul>
    </aside>
    {% raw %}
    <div id="wizard">
        <div id="TaskPane">
            Loading...
        </div>
        <script id="welcomeTask-template" type="text/x-handlebars-template">
            <h2>Welcome to the OT-One Calibration Wizard</h2>
            <div class="steps">
                <div class="step step-hello">
                    <p>This wizard will guide you step by step through the process of:
                        <ul>
                            <li>Loading a Protocol</li>
                            <li>Calibrating Well Positions</li>
                            <li>Calibrating Pipettes</li>
                            <li>Testing Saved Positions</li>
                        </ul>
                    </p>
                    <p>You can always acess this screen menu at any time by clicking the main menu button at the top of the task menu.</p>
                    <a href="#welcome/docs">Next</a>
                </div>
                <div class="step step-docs">
                    <h3>If you prefer, online documentation can be found <a href="https://github.com/OpenTrons/otone_docs" target="_blank">here.</a> </h3>
                    <p>Each task has a navigation bar at the bottom of the screen. Here you can view tips and instructions, perform the current task, or test your saved values. </p>
                    <!-- Link to Info/Jog/Test based on current data -->
                    <ul class="subnav">
                        <li><a class="btn"><i class="fa fa-info-circle fa-lg"></i> Tips</a></li>
                        <li><a class="btn"><i class="fa fa-arrows fa-lg"></i> Jog</a></li>
                        <li><a class="btn"><i class="fa fa-refresh fa-lg"></i> Test</a></li>
                    </ul>
                    <a href="#welcome/hello">Prev</a> |
                    <a href="#file/finfo">Next</a>
                </div>
            </div>
        </script>
        <script id="fileTask-template" type="text/x-handlebars-template">
            <h2>Upload a Protocol File </h2>
            <div class="steps">
                <div class="step step-finfo">
                    <p>bar: {{bar}}; step: {{step}}</p>
                    <p>OpenTrons jobs are described in JSON files that the robot reads as instruction set. You download these files from Mix.Bio. You can choose a pre-made JSON document from the Protocol Database that is ready to run, or customize your own in the Protocol Editor. Once you have the protocol you want downloaded, click below to upload to the Setup / Run interface.</p>
                    <h3>Load Protocol</h3>
                    <input type="file" name="file" id="files" class="inputfile" />
                    <button class="btn" id="loadFile" onclick="readBlob();">Load</button>
                    <div id="byte_content"></div>
                </div>
            </div>
        </script>
        <script id="calibrateTask-template" type="text/x-handlebars-template">
            <h2>Calibrate to Well A:1 ith Left Pipette</h2>
            <div class="steps">
                <div class="step step-info">
                    <p>The first position you save should be your tip rack. Select that position then jog your robot so that the pipette is hovering directly over the A1 tip of the rack that it will use for the run.</p>
                    <p>When you think the pipette is well positioned directly above the tip, flip to the "Pipette" section of the interface, select the correct pipette, and hit "pick up tip." The machine will go up and down three times in an attempt to pick up the tip.</p>
                    <p>NOTE: the distance the machine moves down the Z axis to pick up the tip is defined in the "tip plunge" field in the Pipette definition in the Head section of the JSON OT protocol document.</p>
                    (labware: {{labware}}; step: {{step}})
                    <!-- Next Step generate links based on incoming data -->
                    <ul class="subnav">
                        <li><a class="btn"><i class="fa fa-info-circle fa-lg"></i> Tips</a></li>
                        <li><a class="btn"><i class="fa fa-arrows fa-lg"></i> Jog</a></li>
                        <li><a class="btn"><i class="fa fa-refresh fa-lg"></i> Test</a></li>
                    </ul>
                </div>
                <div class="step step-jog">
                    <div class="jog">
                        <h4>Jog X,Y,Z</h4>
                        <table cellpadding="0" cellspacing="0">
                            <tr>
                                <td></td>
                                <td><a href="#" class="btn" onclick="sendMessage('com.opentrons.driver',driver_id,'command','smoothie','move_to',{X:10});"><i class="fa fa-arrow-up fa-lg"></i></a></td>
                                <td></td>
                                <td class="spacer"></td>
                                <td><a href="#" class="btn btn-z"><i class="fa fa-arrow-up fa-lg"></i></a></td>
                            </tr>
                            <tr>
                                <td class="pull-right"> <a href="#" class="btn "><i class="fa fa-arrow-left fa-lg"></i></a></td>
                                <td>&nbsp;</td>
                                <td class="pull-left"><a href="#" class="btn "><i class="fa fa-arrow-right fa-lg"></i></a></td>
                                <td class="spacer"></td>
                                <td>&nbsp;</td>
                            </tr>
                            <tr>
                                <td></td>
                                <td><a href="#" class="btn"><i class="fa fa-arrow-down fa-lg"></i></a></td>
                                <td>&nbsp;</td>
                                <td class="spacer"></td>
                                <td><a href="#" class="btn btn-z"><i class="fa fa-arrow-down fa-lg"></i></a></td>
                            </tr>
                        </table>
                        <h4>Select Increment [mm]</h4>
                        <div class="btn-group">
                            <a href="#" class="btn btn-inc">100</a>
                            <a href="#" class="btn btn-inc">50</a>
                            <a href="#" class="btn btn-inc">10</a>
                            <a href="#" class="btn btn-inc">1.0</a>
                            <a href="#" class="btn btn-inc">0.5</a>
                            <a href="#" class="btn btn-inc">0.1</a>
                        </div>
                        <div class="btn-group">
                            <a href="#" class="btn btn-inc">Slot Width</a>
                            <a href="#" class="btn btn-inc">Slot Height</a>
                        </div>
                    </div>
                    <div class="jog">
                    </div>
                    <div class="jog-info">
                        <h4>Current Container Name</h4>
                        <p>X:0 Y:0 Z:0</p>
                    </div>
                    <!-- Link to Info/Jog/Test based on current data -->
                    <ul class="subnav">
                        <li><a class="btn"><i class="fa fa-info-circle fa-lg"></i> Tips</a></li>
                        <li><a class="btn"><i class="fa fa-arrows fa-lg"></i> Jog</a></li>
                        <li><a class="btn"><i class="fa fa-refresh fa-lg"></i> Test</a></li>
                    </ul>
                </div>
                <div class="step step-done">
                    This is another step, cool.
                </div>
            </div>
        </script>
        {% endraw %}
        <script type="text/javascript">
        var task = new TaskController().setTask('welcome', {
            step: 'hello',
            foo: 'FOO'
        });

        task.setStep('hello');


        function locationHashChanged() {
            var url = location.hash;
            if (new RegExp('#').test(url)) {
                url = url.replace('#', '');
                var paths = url.split('/');
                var t = paths[0];
                var s = paths[1];
                console.log(s);
                task.setTask(t, {
                    step: s
                });
                task.setStep(s);
            }

        }

        window.onhashchange = locationHashChanged;
        </script>
        <script>
        window.addEventListener('DOMConentLoaded', function() {
            document.getElementById('loadFile').addEventListener('click', function(evt) {
                readBlob();
            }, false);
        });


        function readBlob() {

            var files = document.getElementById('files').files;
            if (!files.length) {
                alert('Please select a file!');
                return;
            }

            var file = files[0];
            var start = 0;
            var stop = file.size - 1;

            var reader = new FileReader();

            reader.onloadend = function(evt) {
                if (evt.target.readyState == FileReader.DONE) {
                    document.getElementById('byte_content').textContent = evt.target.result;
                    var upload = evt.target.result;
                    var protocol = JSON.parse(upload);
                    console.log(protocol);
                }
            };

            var blob = file;
            reader.readAsBinaryString(blob);
        }
        </script>
    </div>
    {% endblock %} {% block scripts %} {% endblock %}
